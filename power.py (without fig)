import numpy as np

# Parameters
n = 3  # Number of buses
Z = np.zeros((n, n), dtype=complex)  # Impedance matrix

# Define the impedance values
Z[0, 0] = 0.1 + 0.4j
Z[1, 1] = 0.15 + 0.5j
Z[2, 2] = 0.2 + 0.6j

# Off-diagonal elements
Z[0, 1] = 0.05 + 0.2j
Z[0, 2] = 0.03 + 0.1j
Z[1, 2] = 0.07 + 0.3j
Z[1, 0] = Z[0, 1]
Z[2, 0] = Z[0, 2]
Z[2, 1] = Z[1, 2]

# Initial conditions
P = np.zeros(n)  # Real power injection
Q = np.zeros(n)  # Reactive power injection

P[0] = 1.0
Q[0] = 0.2

# Calculate the bus voltages
V = np.linalg.inv(Z).dot(P - 1j * Q)

# Print the results
for i in range(n):
    print(f"Bus {i + 1}: Voltage = {abs(V[i]):.4f} âˆ  {np.angle(V[i], deg=True):.2f} degrees")
